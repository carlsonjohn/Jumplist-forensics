epx=window.epx||{},epx.library=window.epx.library||{},epx.library.navigationResizeModule=function(){function init(){window.epx&&window.epx.utilities&&(position=window.epx.utilities.getCookie("TocPosition",position)),$link.live("keydown",function(e){checkForTPressed(e)}),setPosition()}function checkForTPressed(evt){if(evt=evt?evt:event?event:null,evt&&evt.keyCode===84){var target=evt.srcElement!=null?evt.srcElement:evt.target;if(target.tagName.toLowerCase()=="input"||target.tagName.toLowerCase()=="textarea"||evt.ctrlKey||evt.altKey)return;resize()}}function resize(){position++,position>maxPosition&&(position=0,$("#content").css("width",$("#body").css("width"))),window.epx&&window.epx.utilities&&window.epx.utilities.setCookie("TocPosition",position,365,"/",".microsoft.com",null),setPosition()}function setPosition(){$leftNav.attr("class","leftNavResize"+position),$("html").attr("dir")!="rtl"?$link.css("left",$leftNav.css("width")):($.browser.msie?$link.css("left","-"+(parseInt($link.css("width").replace("px",""))+1)+"px"):$link.css("left","-"+$link.css("width")),applyRtlSrc($increase),applyRtlSrc($reset)),$link.css("display","inline-block"),$increase.css("display","none"),$reset.css("display","none"),$("#content").css("width","auto"),window.setTimeout(epx.library.navigationResize.resizeComplete,0)}function applyRtlSrc($element){var src=$element.attr("src"),dotIndex;src.indexOf("_Rtl")==-1&&(dotIndex=src.lastIndexOf("."),$element.attr("src",src.substr(0,dotIndex)+"_Rtl."+src.substr(dotIndex+1,src.length-dotIndex-1)))}function resizeComplete(){$increase.css("display",position==maxPosition?"none":""),$reset.css("display",position!=maxPosition?"none":"")}var position=1,maxPosition=3,$leftNav=$("#leftNav"),$link=$("#NavigationResize"),$increase=$("#NavigationResize > img.cl_nav_resize_open"),$reset=$("#NavigationResize > img.cl_nav_resize_close");return{init:init,resize:resize,resizeComplete:resizeComplete,setPosition:setPosition}},epx.library.navigationResize=epx.library.navigationResizeModule(),$(document).ready(function(){epx.library.navigationResize.init()});;
function positionFeedbackCounter(){var counter=document.getElementById("ratingCounter"),versionSelector,ratingCounterSeperator,h1,mainSec,title,i;if(counter){if(document.getElementById("TopicTitle")){counter.style.display="block";return}if(versionSelector=document.getElementById("curversion"),versionSelector){ratingCounterSeperator=document.getElementById("ratingCounterSeperator"),ratingCounterSeperator&&(versionSelector.parentNode.appendChild(ratingCounterSeperator),ratingCounterSeperator.style.display="block"),counter.style.margin="0px 0px 0px 13px",versionSelector.parentNode.appendChild(counter),counter.style.display="block";return}if(h1=document.getElementsByTagName("h1"),h1&&h1[0]){h1[0].parentNode.insertBefore(counter,h1[0].nextSibling),counter.style.display="block";return}if(document.getElementsByClassName){if(title=document.getElementsByClassName("title"),title&&title.length>0)for(i=0;i<title.length;i++)if(title[i].tagName.toLowerCase()==="span"){title[i].parentNode.insertBefore(counter,title[i].nextSibling),counter.style.display="block";return}}else if(mainSec=document.getElementById("mainSection"),mainSec!=undefined&&mainSec.length>0&&(title=mainSec.getElementsByTagName("span"),title!=undefined&title.length>0))for(i=0;i<title.length;i++)if(title[i].className.toLowerCase()==="title"){title[i].parentNode.insertBefore(counter,title[i].nextSibling),counter.style.display="block";return}counter.style.display="none"}}function toggleRateThisTopic(){var questions=document.getElementById("contentFeedbackQAContainer"),rateThis,prefix;questions||(rateThis=document.getElementById("rateThisTopic"),rateThis&&(rateThis.style.display="none"),prefix=document.getElementById("rateThisPrefix"),prefix&&(prefix.style.display="none"))}typeof MTPS!="undefined"&&MTPS&&typeof MTPS.Utility!="undefined"&&MTPS.Utility?MTPS.Utility.addOnloadEvent(function(){toggleRateThisTopic(),positionFeedbackCounter()}):typeof jQuery!="undefined"&&jQuery&&$(document).ready(function(){toggleRateThisTopic(),positionFeedbackCounter()});;
